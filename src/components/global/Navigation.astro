---
import { Image } from "astro:assets";
import logoImage from "../../assets/images/logo.png";

interface Props {
  isJourneyPage?: boolean;
}

const { isJourneyPage = false } = Astro.props as Props;
---

{isJourneyPage && <div class="journey-nav-hotzone" aria-hidden="true"></div>}
<header
  class={`border-b border-black/5 z-50 bg-base-25/80 backdrop-blur-xl ${
    isJourneyPage ? "journey-nav fixed inset-x-0 top-0" : "sticky top-0"
  }`}
>
  <div class="w-full mx-auto px-6 max-w-6xl lg:px-10">
    <div
      x-data="{ open: false }"
      x-effect="if (open) { const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth; document.body.style.overflow = 'hidden'; document.body.style.paddingRight = scrollbarWidth ? `${scrollbarWidth}px` : ''; } else { document.body.style.overflow = ''; document.body.style.paddingRight = ''; }"
      @keydown.escape.window="open = false"
      class="site-header__row flex items-center justify-between py-4"
    >
      <a href="/" class="brand-logo inline-flex items-center">
        <Image
          src={logoImage}
          alt="SOLA"
          class="brand-logo__image h-10 w-auto"
        />
      </a>
      <button
        @click="open = !open; if (open) { $nextTick(() => $refs.firstNavLink?.focus()) }"
        :aria-expanded="open.toString()"
        aria-controls="main-navigation"
        aria-label="Menu"
        class="mobile-menu-button inline-flex items-center justify-center gap-2 text-base-700 hover:text-black focus:outline-none focus:text-black lg:hidden"
      >
        <svg
          :class="{'rotate-90': open}"
          class="w-6 h-6 transition-transform"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            x-show="!open"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
          <path
            x-show="open"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        <span class="text-sm font-semibold tracking-wide">Menu</span>
      </button>
      <div
        x-show="open"
        x-transition.opacity
        class="fixed inset-0 z-40 bg-transparent lg:hidden"
        @click="open = false"
        aria-hidden="true"
      ></div>
      <nav
        id="main-navigation"
        :class="open ? 'translate-x-0 w-80' : 'translate-x-full w-64'"
        class="fixed right-0 top-0 z-50 flex h-full flex-col bg-white px-6 pb-8 pt-6 shadow-xl transition-[transform,width] duration-300 lg:static lg:z-auto lg:h-auto lg:w-auto lg:translate-x-0 lg:flex lg:flex-row lg:items-center lg:gap-8 lg:bg-transparent lg:p-0 lg:shadow-none"
      >
        <div class="flex items-center justify-between border-b border-black/10 pb-4 lg:hidden">
          <span class="text-sm font-semibold tracking-wide text-base-700">
            Menu
          </span>
          <button
            type="button"
            class="mobile-menu-button inline-flex items-center justify-center text-base-700 hover:text-black focus:outline-none focus:text-black"
            @click="open = false"
            aria-label="Sluit menu"
          >
            <svg
              class="h-5 w-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>
        <div
          class="mt-6 flex flex-col gap-4 text-sm font-medium tracking-wide lg:mt-0 lg:flex-row lg:items-center lg:gap-6 lg:text-[15px]"
        >
          <a
            class="hover:text-accent-700"
            href="/"
            @click="open = false"
            x-ref="firstNavLink"
            >Home</a
          >
          <a class="hover:text-accent-700" href="/reizen" @click="open = false"
            >Reizen</a
          >
          <a class="hover:text-accent-700" href="/over-ons" @click="open = false"
            >Over ons</a
          >
          <a class="hover:text-accent-700" href="/contact" @click="open = false"
            >Contact</a
          >
        </div>
        <div class="mt-6 lg:mt-0 lg:ml-4 flex items-center">
          <a
            href="https://calendly.com/hello-solatravel/30min"
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center justify-center rounded-full bg-accent-600 text-white px-4 py-2 text-xs font-semibold tracking-wide hover:bg-accent-700 transition"
            @click="open = false"
          >
            Plan een gesprek
          </a>
        </div>
      </nav>
    </div>
  </div>
</header>

<style>
  .journey-nav-hotzone {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 16px;
    z-index: 60;
  }

  .journey-nav {
    transform: translateY(-100%);
    opacity: 0;
    pointer-events: none;
    transition: transform 0.25s ease, opacity 0.25s ease;
  }

  .journey-nav-hotzone:hover + .journey-nav,
  .journey-nav:hover,
  .journey-nav:focus-within {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
  }

  @media (hover: none) {
    .journey-nav-hotzone {
      display: none;
    }

    .journey-nav {
      transform: none;
      opacity: 1;
      pointer-events: auto;
    }
  }

  @media (max-width: 768px) {
    .site-header__row {
      align-items: center;
    }

    .brand-logo {
      line-height: 0;
      flex: 0 0 auto;
    }

    .brand-logo__image {
      height: 28px;
      width: auto;
      max-height: 28px;
      object-fit: contain;
      display: block;
    }

    .mobile-menu-button {
      min-width: 44px;
      min-height: 44px;
      padding: 10px;
      border-radius: 9999px;
    }

    .mobile-menu-button:focus-visible {
      outline: 2px solid rgba(0, 0, 0, 0.2);
      outline-offset: 2px;
    }
  }
</style>
